;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="cf96cd9a-1366-4a35-535f-8a990ae7a170")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,862326,e=>{"use strict";var t=e.i(478902),s=e.i(938933),a=e.i(843778);function i({children:e,className:s,tag:a="div",style:i}){let r=`${a}`;return(0,t.jsx)(r,{style:i,children:e})}i.Title=function({className:e,level:s=1,children:a,style:i}){let r=`h${s}`;return(0,t.jsx)(r,{style:i,children:a})},i.Text=function({className:e,children:s,style:a,type:i,disabled:r,mark:n,code:o,keyboard:l,underline:c,strikethrough:u,strong:d,small:m}){return o?(0,t.jsx)("code",{style:a,children:s}):n?(0,t.jsx)("mark",{style:a,children:s}):l?(0,t.jsx)("kbd",{style:a,children:s}):d?(0,t.jsx)("strong",{style:a,children:s}):(0,t.jsx)("span",{style:a,children:s})},i.Link=function({children:e,target:s="_blank",href:a,className:i,onClick:r,style:n}){return(0,t.jsx)("a",{onClick:r,href:a,target:s,rel:"noopener noreferrer",style:n,children:e})};var r=e.i(389959);let n=(0,r.createContext)({type:"text"}),o=e=>{let{type:s}=e;return(0,t.jsx)(n.Provider,{value:{type:s},children:e.children})},l=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function c({children:e,className:s,ulClassName:a,style:i,type:r="text"}){return(0,t.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:i,children:(0,t.jsx)(o,{type:r,children:(0,t.jsx)("ul",{className:a,children:e})})})}c.Item=function({children:e,icon:i,active:r,rounded:n,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:d}){let m=(0,s.default)("menu"),{type:h}=l(),f=[m.item.base];f.push(m.item.variants[h].base),r?f.push(m.item.variants[h].active):f.push(m.item.variants[h].normal);let p=[m.item.content.base];r?p.push(m.item.content.active):p.push(m.item.content.normal);let x=[m.item.icon.base];return r?x.push(m.item.icon.active):x.push(m.item.icon.normal),(0,t.jsxs)("li",{role:"menuitem",className:(0,a.cn)("outline-none",f),style:d,onClick:o,"aria-current":r?"page":void 0,children:[i&&(0,t.jsx)("div",{className:`${x.join(" ")} min-w-fit`,children:i}),(0,t.jsx)("span",{className:p.join(" "),children:e})]})},c.Group=function({children:e,icon:a,title:i}){let r=(0,s.default)("menu"),{type:n}=l();return(0,t.jsxs)("div",{className:[r.group.base,r.group.variants[n]].join(" "),children:[a&&(0,t.jsx)("span",{className:r.group.icon,children:a}),(0,t.jsx)("span",{className:r.group.content,children:i}),e]})},c.Misc=function({children:e}){return(0,t.jsx)("div",{children:(0,t.jsx)(i.Text,{children:(0,t.jsx)("span",{children:e})})})},e.s(["Menu",0,c],862326)},388147,799793,e=>{"use strict";var t=e.i(478902),s=e.i(587433),a=e.i(862326),i=e.i(215261),r=e.i(837710);let n=({name:e="",isActive:n,isExternal:o,icon:l,rightIcon:c,url:u="",target:d="_self",onClick:m,textClassName:h="",hoverText:f="",label:p})=>{let x=(0,t.jsx)(a.Menu.Item,{icon:l,rounded:!0,active:n,onClick:m,children:(0,t.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 min-w-0 flex-1",title:f||("string"==typeof e?e:""),children:[(0,t.jsx)("span",{className:"truncate flex-1 min-w-0",children:e}),void 0!==p&&(0,t.jsx)(s.Badge,{variant:"new"===p.toLowerCase()?"success":"warning",className:"flex-shrink-0",children:p})]}),c&&(0,t.jsx)("div",{children:c})]})});return u?o?(0,t.jsx)(r.Button,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:l,children:(0,t.jsx)(i.default,{href:u,target:"_blank",rel:"noreferrer",children:e})}):(0,t.jsx)(i.default,{href:u,className:"block",target:d,children:x}):x};e.s(["default",0,n],799793),e.s(["ProductMenu",0,({page:e,menu:i})=>(0,t.jsx)("div",{className:"flex flex-col space-y-8",children:(0,t.jsx)(a.Menu,{type:"pills",children:i.map((r,o)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"my-6 space-y-8",children:(0,t.jsxs)("div",{className:"mx-3",children:[(0,t.jsx)(a.Menu.Group,{title:r.title?(0,t.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,t.jsx)("span",{children:r.title}),r.isPreview&&(0,t.jsx)(s.Badge,{variant:"warning",children:"Not production ready"})]}):null}),(0,t.jsx)("div",{children:r.items.map(s=>{let a=s.pages?s.pages.includes(e??""):e===s.key;return(0,t.jsx)(n,{url:s.url,name:s.name,icon:s.icon,rightIcon:s.rightIcon,isActive:a,isExternal:s.isExternal,target:s.isExternal?"_blank":"_self",label:s.label},s.key)})})]})}),o!==i.length-1&&(0,t.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},r.key||r.title))})})],388147)},114378,e=>{"use strict";var t=e.i(4196),s=e.i(389959),a=e.i(355901);function i({enabled:e,urlKey:a,select:i,onError:r}){let[n,o]=(0,t.useQueryState)(a,t.parseAsString.withOptions({history:"push",clearOnDefault:!0})),l=(0,s.useMemo)(()=>n?i(n):void 0,[n,i]);return(0,s.useEffect)(()=>{e&&n&&!l&&(r(Error("not found"),n),o(null))},[e,r,n,o,l]),{value:l,setValue:o}}e.s(["handleErrorOnDelete",0,(e,t,s)=>{t!==e.current?a.toast.error(s):e.current=null},"useQueryStateWithSelect",()=>i])},450049,e=>{"use strict";var t=e.i(867088),s=e.i(242882),a=e.i(55956),i=e.i(389959),r=e.i(993394),n=e.i(460988),o=e.i(234745),l=e.i(520124),c=e.i(281192);e.s(["default",0,function({projectRef:e,table:u,filterOverride:d,limit:m}){let h,f,p=(0,r.getDefaultHelper)(r.PREVIEWER_DATEPICKER_HELPERS),[x,g]=(0,i.useState)(new Date().toISOString()),{timestampStart:y,timestampEnd:v,filters:_,search:j}=(0,c.useLogsUrlState)(),b=(0,i.useMemo)(()=>y||p.calcFrom(),[y,p]),w=(0,i.useMemo)(()=>v||p.calcTo(),[v,p]),S=(0,i.useMemo)(()=>({..._,...d,...j?{search_query:j}:{}}),[JSON.stringify(_),JSON.stringify(d),j]),k=(0,i.useMemo)(()=>({iso_timestamp_start:b,iso_timestamp_end:w,sql:(0,n.genDefaultQuery)(u,S,m)}),[b,w,u,S,m]),N=(0,i.useMemo)(()=>["projects",e,"logs",k],[e,k]),{data:E,isSuccess:P,isLoading:C,isRefetching:A,error:M,fetchNextPage:$,isFetchingNextPage:T,refetch:D}=(0,t.useInfiniteQuery)({queryKey:N,queryFn:async({signal:t,pageParam:s})=>{let{data:a,error:i}=await (0,o.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{...k,iso_timestamp_end:s||k.iso_timestamp_end}},signal:t});if(i)throw i;return a},refetchOnWindowFocus:!1,initialPageParam:void 0,getNextPageParam(e){if((e.result?.length??0)===0)return;let t=e.result.length,{timestamp:s}=e.result[t-1];return a.default.utc(Number(s/1e3)).toISOString()}}),{logData:U,error:L,oldestTimestamp:I}=(0,i.useMemo)(()=>{let e=[],t=M?M.message:null;E?.pages?.forEach(s=>{s?.result&&(e=[...e,...s.result]),!t&&s?.error&&(t=s.error)});let s=e.length>0?e[e.length-1]?.timestamp:void 0;return{logData:e,error:t,oldestTimestamp:s}},[E?.pages]),O=(0,i.useMemo)(()=>(0,n.genCountQuery)(u,S),[u,S]),F=(0,i.useMemo)(()=>["projects",e,"logs-count",{projectRef:e,sql:O,iso_timestamp_start:x,iso_timestamp_end:w,table:u,mergedFilters:S}],[e,O,x,w,u,S]),{data:R}=(0,s.useQuery)({queryKey:F,queryFn:async({signal:t})=>{let{data:s,error:a}=await (0,o.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{sql:O,iso_timestamp_start:x,iso_timestamp_end:w}},signal:t});if(a)throw a;return s},refetchOnWindowFocus:!1,refetchInterval:6e4,enabled:!!(!L&&E&&E?.pages?.length>0)}),B=R?.result?.[0]?.count??0,q=(0,i.useMemo)(()=>(0,n.genChartQuery)(u,k,S),[u,k,S]),H=(0,i.useMemo)(()=>["projects",e,"logs-chart",{projectRef:e,sql:q,iso_timestamp_start:b,iso_timestamp_end:w}],[e,q,b,w]),{data:Q,refetch:z}=(0,s.useQuery)({queryKey:H,queryFn:async({signal:t})=>{let{data:s,error:a}=await (0,o.get)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:{iso_timestamp_start:b,iso_timestamp_end:w,sql:q}},signal:t});if(a)throw a;return s},refetchOnWindowFocus:!1}),K=(0,i.useCallback)(async()=>{g(new Date().toISOString()),z(),D()},[D,z]),W=(h=Q?.result??[],f="timestamp",(0,i.useMemo)(()=>0!==h.length&&(0,n.isUnixMicro)(h[0][f])?h?.map(e=>(e[f]=(0,n.unixMicroToIsoTimestamp)(e[f]),e)):h,[JSON.stringify(h)])),{data:G,error:Y}=(0,l.useFillTimeseriesSorted)(W,"timestamp","count",0,b,w||new Date().toISOString());return{newCount:B,logData:U,isSuccess:P,isLoading:C||A,isLoadingOlder:T,error:L||Y,filters:S,params:k,oldestTimestamp:I?String(I):void 0,eventChartData:G,refresh:K,loadOlder:()=>$()}}],450049)},520124,e=>{"use strict";var t=e.i(460988),s=e.i(389959);e.s(["useFillTimeseriesSorted",0,(...e)=>(0,s.useMemo)(()=>{let[s,a]=e;if(!s[0]?.[a])return{data:s,error:void 0,isError:!1};try{return{data:(0,t.fillTimeseries)(...e).sort((t,s)=>new Date(t[e[1]])-new Date(s[e[1]])),error:void 0,isError:!1}}catch(e){return{data:[],error:e,isError:!0}}},[JSON.stringify(e[0]),...e])])},223600,e=>{"use strict";var t=e.i(478902),s=e.i(370410),a=e.i(816467),i=e.i(389959),r=e.i(837710),n=e.i(843778),o=e.i(375761);let l=(0,i.forwardRef)(({text:e,asyncText:l,iconOnly:c=!1,children:u,onClick:d,copyLabel:m="Copy",copiedLabel:h="Copied",...f},p)=>{let[x,g]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{if(!x)return;let e=setTimeout(()=>g(!1),2e3);return()=>clearTimeout(e)},[x]),(0,t.jsx)(r.Button,{ref:p,onClick:async t=>{let s=l?await l():e;g(!0),(0,o.copyToClipboard)(s),d?.(t)},...f,className:(0,n.cn)({"px-1":c},f.className),icon:x?(0,t.jsx)(s.Check,{strokeWidth:2,className:"text-brand"}):f.icon??(0,t.jsx)(a.Copy,{}),children:!c&&(0,t.jsx)(t.Fragment,{children:u??(x?h:m)})})});l.displayName="CopyButton",e.s(["default",0,l])},40892,e=>{"use strict";var t=e.i(478902),s=e.i(389959),a=e.i(843778),i=e.i(837710),r=e.i(253214);let n=(0,s.forwardRef)(({children:e,customFooter:n,description:o,hideFooter:l=!1,alignFooter:c="left",layout:u="horizontal",loading:d=!1,cancelText:m="Cancel",onConfirm:h=()=>{},onCancel:f=()=>{},confirmText:p="Confirm",showCloseButton:x=!0,footerBackground:g,variant:y="success",visible:v=!1,size:_="large",style:j,overlayStyle:b,contentStyle:w,triggerElement:S,header:k,modal:N,defaultOpen:E,...P},C)=>{let[A,M]=s.default.useState(!!v&&v);(0,s.useEffect)(()=>{M(v)},[v]);let $=n||(0,t.jsxs)("div",{className:"flex w-full space-x-2",style:{width:"100%",justifyContent:"vertical"===u?"center":"right"===c?"flex-end":"flex-start"},children:[(0,t.jsx)(i.Button,{type:"default",onClick:f,disabled:d,children:m}),(0,t.jsx)(i.Button,{onClick:h,disabled:d,loading:d,type:"danger"===y?"danger":"warning"===y?"warning":"primary",children:p})]});return(0,t.jsxs)(r.Dialog,{open:A,defaultOpen:E,onOpenChange:function(e){void 0===v||e?M(e):f()},modal:N,children:[S&&(0,t.jsx)(r.DialogTrigger,{children:S}),(0,t.jsxs)(r.DialogContent,{ref:C,hideClose:!x,...P,size:_,children:[k||o?(0,t.jsxs)(r.DialogHeader,{className:(0,a.cn)("border-b"),padding:"small",children:[k&&(0,t.jsx)(r.DialogTitle,{children:k}),o&&(0,t.jsx)(r.DialogDescription,{children:o})]}):null,e,!l&&(0,t.jsx)(r.DialogFooter,{padding:"small",children:$})]})]})}),o=(0,s.forwardRef)(({...e},s)=>(0,t.jsx)(r.DialogSection,{ref:s,...e,padding:"small",className:(0,a.cn)(e.className)})),l=(0,s.forwardRef)(({...e},s)=>(0,t.jsx)(r.DialogSectionSeparator,{ref:s,...e}));n.Content=o,n.Separator=l,e.s(["Modal",0,n],40892)},61187,e=>{"use strict";let t=(0,e.i(388019).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],61187)},281192,e=>{"use strict";var t=e.i(4196);let s={},a=e=>(0,t.createParser)({parse:t=>t??e,serialize:e=>e||""});function i(){let[e,i]=(0,t.useQueryState)("s",a("")),[r,n]=(0,t.useQueryState)("its",a("")),[o,l]=(0,t.useQueryState)("ite",a("")),[c,u]=(0,t.useQueryState)("log",a("")),[d,m]=(0,t.useQueryState)("f",(0,t.createParser)({parse:e=>{if(!e)return s;try{return JSON.parse(e)}catch(e){return s}},serialize:e=>{if(!e)return"";try{return JSON.stringify(e)}catch(e){return""}}})),h=d||s,f=e=>{i(e||"")},p=e=>{m(e||s)};return{search:e||"",timestampStart:r||"",timestampEnd:o||"",selectedLogId:c||null,filters:h,setSearch:f,setTimeRange:(e,t)=>{n(e||""),l(t||"")},setSelectedLogId:e=>{u(e||"")},setFilters:p,updateFilter:(e,t)=>{p({...h,[e]:t})},reset:()=>{f(""),n(""),l(""),u(""),m(s)}}}e.s(["useLogsUrlState",()=>i])},870152,e=>{"use strict";var t=e.i(532480);e.s(["InfoIcon",()=>t.default])},248210,e=>{"use strict";var t=e.i(478902),s=e.i(843778);e.s(["LoadingLine",0,({loading:e})=>(0,t.jsx)("div",{className:"relative overflow-hidden w-full h-px bg-border m-auto",children:(0,t.jsx)("span",{className:(0,s.cn)("absolute w-[80px] h-px ml-auto mr-auto left-0 right-0 text-center block top-0","transition-all","line-loading-bg-light dark:line-loading-bg",e&&"animate-line-loading-slower opacity-100",e?"opacity-100":"opacity-0")})})])},14703,e=>{"use strict";var t=e.i(242882),s=e.i(356003),a=e.i(234745),i=e.i(10429),r=e.i(389959),n=e.i(294285);async function o({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:s,error:i}=await (0,a.get)("/platform/auth/{ref}/config",{params:{path:{ref:e}},signal:t});return i&&(0,a.handleError)(i),s}e.s(["getProjectAuthConfig",()=>o,"useAuthConfigPrefetch",0,({projectRef:e})=>{let t=(0,s.useQueryClient)();return(0,r.useCallback)(()=>{e&&t.prefetchQuery({queryKey:n.authKeys.authConfig(e),queryFn:({signal:t})=>o({projectRef:e},t)})},[t,e])},"useAuthConfigQuery",0,({projectRef:e},{enabled:s=!0,...a}={})=>(0,t.useQuery)({queryKey:n.authKeys.authConfig(e),queryFn:({signal:t})=>o({projectRef:e},t),enabled:s&&i.IS_PLATFORM&&void 0!==e,...a})])},785951,e=>{"use strict";var t=e.i(478902),s=e.i(898452);e.i(128328);var a=e.i(657588),i=e.i(158639),r=e.i(388147),n=e.i(14703),o=e.i(912793),l=e.i(951138),c=e.i(825713),u=e.i(887902);let d=()=>{let e=(0,s.useRouter)(),{ref:l="default"}=(0,i.useParams)(),c=(0,a.useFlag)("authOverviewPage"),d=(0,a.useFlag)("EnableOAuth21"),{authenticationSignInProviders:m,authenticationRateLimits:h,authenticationEmails:f,authenticationMultiFactor:p,authenticationAttackProtection:x,authenticationPerformance:g}=(0,o.useIsFeatureEnabled)(["authentication:sign_in_providers","authentication:rate_limits","authentication:emails","authentication:multi_factor","authentication:attack_protection","authentication:performance"]);(0,n.useAuthConfigPrefetch)({projectRef:l});let y=e.pathname.split("/")[4];return(0,t.jsx)(r.ProductMenu,{page:y,menu:(0,u.generateAuthMenu)(l,{authenticationSignInProviders:m,authenticationRateLimits:h,authenticationEmails:f,authenticationMultiFactor:p,authenticationAttackProtection:x,authenticationShowOverview:c,authenticationOauth21:d,authenticationPerformance:g})})},m=(0,l.withAuth)(({children:e})=>(0,t.jsx)(c.ProjectLayout,{title:"Authentication",product:"Authentication",productMenu:(0,t.jsx)(d,{}),isBlocking:!1,children:e}));e.s(["default",0,m])},309233,e=>{"use strict";var t=e.i(38429),s=e.i(356003),a=e.i(355901),i=e.i(234745),r=e.i(294285);async function n({projectRef:e,config:t}){let{data:s,error:a}=await (0,i.patch)("/platform/auth/{ref}/config",{params:{path:{ref:e}},body:{...t}});return a&&(0,i.handleError)(a),s}e.s(["useAuthConfigUpdateMutation",0,({onSuccess:e,onError:i,...o}={})=>{let l=(0,s.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>n(e),async onSuccess(t,s,a){let{projectRef:i}=s;await l.invalidateQueries({queryKey:r.authKeys.authConfig(i)}),await e?.(t,s,a)},async onError(e,t,s){void 0===i?a.toast.error(`Failed to update auth configuration: ${e.message}`):i(e,t,s)},...o})}])},908027,e=>{"use strict";var t=e.i(478902),s=e.i(843778),a=e.i(513826);e.s(["FormHeader",0,({title:e,description:i,docsUrl:r,actions:n,className:o})=>(0,t.jsxs)("div",{className:(0,s.cn)(`w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ${o}`),children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"text-foreground text-xl prose",children:e}),i&&(0,t.jsx)("p",{className:"prose text-sm max-w-2xl",children:i})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==r&&(0,t.jsx)(a.DocsButton,{href:r}),n]})]})])},502035,e=>{"use strict";var t=e.i(672483);e.s(["ExternalLinkIcon",()=>t.default])},959076,e=>{"use strict";function t(e,t){let s="00000000-0000-0000-0000-000000000000".split("").map((t,s)=>"-"===t?t:e[s]??t);if(e.length>=s.length)return s.join("");if(e.length&&e.length<15&&(s[14]="4"),e.length&&e.length<20&&(s[19]=t?"b":"8"),t)for(let t=e.length;t<s.length;t+=1)"0"===s[t]&&(s[t]="f");return s.join("")}function s(e){if(!e)return[e,void 0];let t=e.charCodeAt(e.length-1);if(122===t)return[e,e+"~"];if(t>=126)return[e,e+" "];let s=e.substring(0,e.length-1)+String.fromCharCode(t+1);return[e,s]}e.s(["prefixToUUID",()=>t,"stringRange",()=>s])},258732,e=>{"use strict";var t=e.i(959076);let s=50;var a=e.i(867088),i=e.i(714403),r=e.i(635494);e.i(10429);var n=e.i(837508),o=e.i(294285);e.s(["useUsersInfiniteQuery",0,({projectRef:e,connectionString:l,keywords:c,filter:u,providers:d,sort:m,order:h,column:f},{enabled:p=!0,...x}={})=>{let{data:g}=(0,r.useSelectedProjectQuery)(),y=g?.status===n.PROJECT_STATUS.ACTIVE_HEALTHY;return(0,a.useInfiniteQuery)({queryKey:o.authKeys.usersInfinite(e,{keywords:c,filter:u,providers:d,sort:m,order:h,column:f}),queryFn:({signal:a,pageParam:r})=>(0,i.executeSql)({projectRef:e,connectionString:l,sql:(({page:e=0,verified:a,keywords:i,providers:r,sort:n,order:o,limit:l=s,column:c,startAt:u})=>{let d=[];if(i&&""!==i){let e=i.replaceAll("'","''");d.push(`id::text like '%${e}%' or email like '%${e}%' or phone like '%${e}%' or raw_user_meta_data->>'full_name' ilike '%${e}%' or raw_user_meta_data->>'first_name' ilike '%${e}%' or raw_user_meta_data->>'last_name' ilike '%${e}%' or raw_user_meta_data->>'display_name' ilike '%${e}%'`)}"verified"===a?d.push("email_confirmed_at IS NOT NULL or phone_confirmed_at IS NOT NULL"):"anonymous"===a?d.push("is_anonymous is true"):"unverified"===a&&d.push("email_confirmed_at IS NULL AND phone_confirmed_at IS NULL"),r&&r.length>0&&(r.includes("saml 2.0")?d.push(`(select jsonb_agg(case when value ~ '^sso' then 'sso' else value end) from jsonb_array_elements_text((raw_app_meta_data ->> 'providers')::jsonb)) ?| array[${r.map(e=>"saml 2.0"===e?"'sso'":`'${e}'`).join(", ")}]`.trim()):d.push(`(raw_app_meta_data->>'providers')::jsonb ?| array[${r.map(e=>`'${e}'`).join(", ")}]`));let m=d.map(e=>`(${e})`).join(" and "),h=`${d.length>0?` where ${m}`:""}
    order by
      "${n??"created_at"}" ${o??"desc"} nulls last
    limit
      ${l}
    offset
      ${e*l}
  `,f=u?">":">=";if("email"===c){let e=(0,t.stringRange)(i??"");h=`where lower(email) ${f} '${u||e[0]}' ${e[1]?`and lower(email) < '${e[1]}'`:""} and instance_id = '00000000-0000-0000-0000-000000000000'::uuid order by instance_id, lower(email) asc limit ${l}`}else if("phone"===c){let e=(0,t.stringRange)(i??"");h=`where phone ${f} '${u||e[0]}' ${e[1]?`and phone < '${e[1]}'`:""} order by phone asc limit ${l}`}else"id"===c&&(h=(0,t.prefixToUUID)(i??"",!1)===i?`where id = '${i}' order by id asc limit ${l}`:`where id ${f} '${u||(0,t.prefixToUUID)(i??"",!1)}' and id < '${(0,t.prefixToUUID)(i??"",!0)}' order by id asc limit ${l}`);let p=`
    select
      auth.users.id,
      auth.users.email,
      auth.users.banned_until,
      auth.users.created_at,
      auth.users.confirmed_at,
      auth.users.confirmation_sent_at,
      auth.users.is_anonymous,
      auth.users.is_sso_user,
      auth.users.invited_at,
      auth.users.last_sign_in_at,
      auth.users.phone,
      auth.users.raw_app_meta_data,
      auth.users.raw_user_meta_data,
      auth.users.updated_at
    from
      auth.users
    ${h}`;return`
with
  users_data as (${p})
select
  *,
  coalesce(
    (
      select
        array_agg(distinct i.provider)
      from
        auth.identities i
      where
        i.user_id = users_data.id
    ),
    '{}'::text[]
  ) as providers
from
  users_data;
  `.trim()})({page:f?void 0:r,verified:u,keywords:c,providers:d,sort:m??"id",order:h??"asc",limit:50,column:f,startAt:f?r:void 0})},a),enabled:p&&void 0!==e&&y,initialPageParam:void 0,getNextPageParam(e,t){let s=e.result.length>=50;if(f){let t=e.result[e.result.length-1];return s&&t?t[f]:void 0}{let e=t.length;if(!s)return;return e}},...x})}],258732)},525070,e=>{"use strict";var t=e.i(478902);let s=(0,e.i(388019).default)("BookOpenText",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}],["path",{d:"M6 8h2",key:"30oboj"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M16 12h2",key:"7q9ll5"}]]);e.i(128328);var a=e.i(158639),i=e.i(162082),r=e.i(265735),n=e.i(876298),o=e.i(215312);e.s(["APIDocsButton",0,({section:e,source:l})=>{let c=(0,n.useAppStateSnapshot)(),{ref:u}=(0,a.useParams)(),{data:d}=(0,r.useSelectedOrganizationQuery)(),{mutate:m}=(0,i.useSendEventMutation)();return(0,t.jsx)(o.ButtonTooltip,{size:"tiny",type:"default",onClick:()=>{e&&c.setActiveDocsSection(e),c.setShowProjectApiDocs(!0),m({action:"api_docs_opened",properties:{source:l},groups:{project:u??"Unknown",organization:d?.slug??"Unknown"}})},icon:(0,t.jsx)(s,{}),className:"h-7 w-7",tooltip:{content:{side:"bottom",text:"API Docs"}}})}],525070)},999918,e=>{"use strict";let t=(0,e.i(388019).default)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);e.s(["ShieldOff",()=>t],999918)},899850,e=>{"use strict";e.s(["COUNT_ESTIMATE_SQL",0,`
CREATE OR REPLACE FUNCTION pg_temp.count_estimate(
    query text
) RETURNS integer LANGUAGE plpgsql AS $$
DECLARE
    plan jsonb;
BEGIN
    EXECUTE 'EXPLAIN (FORMAT JSON)' || query INTO plan;
    RETURN plan->0->'Plan'->'Plan Rows';
END;
$$;
`.trim(),"THRESHOLD_COUNT",0,5e4])},843142,e=>{"use strict";var t=e.i(130843);e.s(["SelectSeparator_Shadcn_",()=>t.SelectSeparator])},526925,e=>{"use strict";e.s(["formatEstimatedCount",0,e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),s=t>4?"T":["","K","M","B","T"][t],a=e/Math.pow(1e3,t>4?4:t);return""===s?`${a}`:`${a.toFixed(1)}${s}`}])},42081,e=>{"use strict";let t="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;e.s(["DEBUG_BUILD",()=>t])},886514,e=>{"use strict";let t=(0,e.i(388019).default)("ArrowDownNarrowWide",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h4",key:"6d7r33"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h10",key:"1438ji"}]]);e.s(["ArrowDownNarrowWide",()=>t],886514)},701257,e=>{"use strict";var t=e.i(583369);e.s(["ArrowDownWideNarrow",()=>t.default])},672296,e=>{"use strict";function t(e){return e.split("#")[0]}function s(e,t={}){let{maxDepth:a=3,redaction:i="[REDACTED]",truncationNotice:r="[REDACTED: max depth reached]",sensitiveKeys:n=[]}=t,o=new Set(["password","passwd","pwd","pass","secret","token","id_token","access_token","refresh_token","apikey","api_key","api-key","apiKey","key","privatekey","private_key","client_secret","clientSecret","auth","authorization","ssh_key","sshKey","bearer","session","cookie","csrf","xsrf","ip","ip_address","ipAddress","aws_access_key_id","aws_secret_access_key","gcp_service_account_key",...n].map(e=>e.toLowerCase())),l=[{re:/\b(?:(?:25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|1?\d?\d)\b/g,reason:"ip"},{re:/\b(?:[A-Fa-f0-9]{1,4}:){2,7}[A-Fa-f0-9]{1,4}\b/g,reason:"ip6"},{re:/\b(AKI|ASI)A[0-9A-Z]{16}\b/g,reason:"aws_access_key_id"},{re:/\b[0-9A-Za-z/+]{40}\b/g,reason:"aws_secret_access_key_like"},{re:/\bBearer\s+[A-Za-z0-9\-._~+/]+=*\b/g,reason:"bearer"},{re:/\b[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\b/g,reason:"jwt_like"},{re:/\b[A-Za-z0-9_\-]{24,64}\b/g,reason:"long_token"}],c=new WeakMap;function u(e){let t=e;for(let{re:e}of l)t=t.replace(e,i);return t}function d(e){return o.has(String(e).toLowerCase())}return e.map(e=>(function e(t,s){if(null==t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t;if("string"==typeof t)return u(t);if("function"==typeof t)return"[Function]";if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return t.toString();if(ArrayBuffer.isView(t)&&!(t instanceof DataView))return`[TypedArray byteLength=${t.byteLength}]`;if(t instanceof ArrayBuffer)return`[ArrayBuffer byteLength=${t.byteLength}]`;if(s>=a)return r;if("object"==typeof t){if(c.has(t))return"[Circular]";if(Array.isArray(t)){let a=[];c.set(t,a);for(let i=0;i<t.length;i++)a[i]=e(t[i],s+1);return a}if(function(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}(t)){let a={};for(let[r,n]of(c.set(t,a),Object.entries(t)))d(r)?a[r]=i:a[r]=e(n,s+1);return a}if(t instanceof Map){let a=[];for(let[r,n]of(c.set(t,a),t.entries())){let t=d(r)?i:e(r,s+1),o=d(r)?i:e(n,s+1);a.push([t,o])}return a}if(t instanceof Set){let a=[];for(let i of(c.set(t,a),t.values()))a.push(e(i,s+1));return a}if(t instanceof URL)return t.toString();if(t instanceof Error){let e={name:t.name,message:u(t.message),stack:r};return c.set(t,e),e}try{return u(String(t))}catch{return u(Object.prototype.toString.call(t))}}return u(String(t))})(e,0))}e.s(["sanitizeArrayOfObjects",()=>s,"sanitizeUrlHashParams",()=>t])},360608,e=>{"use strict";var t=e.i(899850),s=e.i(959076),a=e.i(479084),i=e.i(242882),r=e.i(714403),n=e.i(294285);async function o({projectRef:e,connectionString:i,keywords:n,filter:o,providers:l,forceExactCount:c,column:u},d){let m=(({filter:e,keywords:i,providers:r,forceExactCount:n=!1,column:o})=>{let l=i&&""!==i,c=[],u="select count(*) from auth.users";if(o&&l){if("email"===o){let e=(0,s.stringRange)(i),t=(0,a.literal)(e[0]),r=e[1]?(0,a.literal)(e[1]):null;c.push(`lower(email) >= ${t}${r?` and lower(email) < ${r}`:""} and instance_id = '00000000-0000-0000-0000-000000000000'::uuid`)}else if("phone"===o){let e=(0,s.stringRange)(i),t=(0,a.literal)(e[0]),r=e[1]?(0,a.literal)(e[1]):null;c.push(`phone >= ${t}${r?` and phone < ${r}`:""}`)}else if("id"===o){let e=(0,s.prefixToUUID)(i,!1);if(e===i)c.push(`id = ${(0,a.literal)(i)}`);else{let t=(0,s.prefixToUUID)(i,!0);c.push(`id >= ${(0,a.literal)(e)} and id < ${(0,a.literal)(t)}`)}}}else{if(l){let e=(0,a.literal)(`%${i}%`);c.push(`id::text ilike ${e} or email ilike ${e} or phone ilike ${e}`)}if("verified"===e?c.push("email_confirmed_at IS NOT NULL or phone_confirmed_at IS NOT NULL"):"anonymous"===e?c.push("is_anonymous is true"):"unverified"===e&&c.push("email_confirmed_at IS NULL AND phone_confirmed_at IS NULL"),r&&r.length>0)if(r.includes("saml 2.0")){let e=r.map(e=>"saml 2.0"===e?"sso":e);c.push(`(select jsonb_agg(case when value ~ '^sso' then 'sso' else value end) from jsonb_array_elements_text((raw_app_meta_data ->> 'providers')::jsonb)) ?| array[${(0,a.literal)(e)}]`.trim())}else c.push(`(raw_app_meta_data->>'providers')::jsonb ?| array[${(0,a.literal)(r)}]`)}let d=c.map(e=>`(${e})`).join(" and "),m=c.length>0?` where ${d}`:"";if(n)return`select (${u}${m}), false as is_estimate;`;{let e=`select * from auth.users${m}`,s=`${u}${m}`,i=(0,a.literal)(e);return`
${t.COUNT_ESTIMATE_SQL}

with approximation as (select reltuples as estimate from pg_class where oid = 'auth.users'::regclass)
select 
  case 
    when estimate = -1 then (select pg_temp.count_estimate(${i}))::int
    when estimate > ${t.THRESHOLD_COUNT} then ${c.length>0?`(select pg_temp.count_estimate(${i}))::int`:"estimate::int"}
    else (${s})
  end as count,
  estimate = -1 or estimate > ${t.THRESHOLD_COUNT} as is_estimate
from approximation;
`.trim()}})({filter:o,keywords:n,providers:l,forceExactCount:c,column:u}),{result:h}=await (0,r.executeSql)({projectRef:e,connectionString:i,sql:m,queryKey:["users-count"]},d),f=h?.[0]?.count,p=h?.[0]?.is_estimate;if("number"!=typeof f)throw Error("Error fetching users count");return{count:f,is_estimate:p??!0}}e.s(["useUsersCountQuery",0,({projectRef:e,connectionString:t,keywords:s,filter:a,providers:r,forceExactCount:l,column:c},{enabled:u=!0,...d}={})=>(0,i.useQuery)({queryKey:n.authKeys.usersCount(e,{keywords:s,filter:a,providers:r,forceExactCount:l,column:c}),queryFn:({signal:i})=>o({projectRef:e,connectionString:t,keywords:s,filter:a,providers:r,forceExactCount:l,column:c},i),enabled:u&&void 0!==e,...d})],360608)},432639,e=>{"use strict";let t=(0,e.i(388019).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>t],432639)},108444,e=>{"use strict";let t=(0,e.i(388019).default)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);e.s(["Ban",()=>t],108444)},875430,56714,54592,795238,e=>{"use strict";var t=e.i(478902);e.i(128328);var s=e.i(158639),a=e.i(355901),i=e.i(38429),r=e.i(356003),n=e.i(234745),o=e.i(294285);async function l({projectRef:e,userId:t}){let{data:s,error:a}=await (0,n.del)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:e,id:t}}});return a&&(0,n.handleError)(a),s}let c=({onSuccess:e,onError:t,...s}={})=>{let n=(0,r.useQueryClient)();return(0,i.useMutation)({mutationFn:e=>l(e),async onSuccess(t,s,a){let{projectRef:i,skipInvalidation:r=!1}=s;r||await Promise.all([n.invalidateQueries({queryKey:o.authKeys.usersInfinite(i)})]),await e?.(t,s,a)},async onError(e,s,i){void 0===t?a.toast.error(`Failed to delete user: ${e.message}`):t(e,s,i)},...s})};e.s(["useUserDeleteMutation",0,c],56714);var u=e.i(466472);e.s(["DeleteUserModal",0,({visible:e,selectedUser:i,onClose:r,onDeleteSuccess:n})=>{let{ref:o}=(0,s.useParams)(),{mutate:l,isPending:d}=c({onSuccess:()=>{a.toast.success(`Successfully deleted ${i?.email}`),n?.()}}),m=async()=>o?i?.id===void 0?a.toast.error("Failed to delete user: User ID not found"):void l({projectRef:o,userId:i.id}):console.error("Project ref is required");return(0,t.jsx)(u.default,{visible:e,variant:"destructive",title:"Confirm to delete user",loading:d,confirmLabel:"Delete",onCancel:()=>r(),onConfirm:()=>m(),alert:{title:"Deleting a user is irreversible",description:"This will remove the selected the user from the project and all associated data."},children:(0,t.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the user"," ",i?.email??i?.phone??"this user","?"]})})}],875430);var d=e.i(816467),m=e.i(223600),h=e.i(843778),f=e.i(10429),p=e.i(441730);let x="px-5 py-5",g=p.PROVIDERS_SCHEMAS.map(e=>({name:e.title,value:"key"in e?e.key:e.title.toLowerCase(),icon:`${f.BASE_PATH}/img/icons/${e.misc.iconKey}.svg`,iconClass:"GitHub"===e.title?"dark:invert":""})).concat(p.PROVIDER_PHONE.properties.SMS_PROVIDER.enum.map(e=>({name:e.label,value:e.value,icon:`${f.BASE_PATH}/img/icons/${e.icon}`,iconClass:""})));e.s(["MAX_BULK_DELETE",0,20,"PANEL_PADDING",0,x,"PHONE_NUMBER_LEFT_PREFIX_REGEX",0,/^[+]?[0-9]{0,15}$/,"PROVIDER_FILTER_OPTIONS",0,g,"USERS_TABLE_COLUMNS",0,[{id:"img",name:"",minWidth:95,width:95,resizable:!1},{id:"id",name:"UID",width:280},{id:"name",name:"Display name",minWidth:0,width:150},{id:"email",name:"Email",width:300},{id:"phone",name:"Phone"},{id:"providers",name:"Providers",minWidth:150},{id:"provider_type",name:"Provider type",minWidth:150},{id:"created_at",name:"Created at",width:260},{id:"last_sign_in_at",name:"Last sign in at",width:260}],"UUIDV4_LEFT_PREFIX_REGEX",0,/^(?:[0-9a-f]{1,8}|[0-9a-f]{8}-|[0-9a-f]{8}-[0-9a-f]{1,4}|[0-9a-f]{8}-[0-9a-f]{4}-|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{0,3}|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{0,3}|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{0,12})$/i],54592);var y=e.i(71011);e.s(["UserHeader",0,({user:e})=>{let s=(0,y.getDisplayName)(e),a="-"!==s,i=null!==e.phone,r=e.is_anonymous;return(0,t.jsx)("div",{className:(0,h.cn)(x),children:i?(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("p",{children:e.phone}),(0,t.jsx)(m.default,{iconOnly:!0,type:"text",icon:(0,t.jsx)(d.Copy,{}),className:"px-1",text:e?.phone??""})]}):r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:"Anonymous user"}),(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("p",{className:"text-foreground-light text-sm",children:e.id}),(0,t.jsx)(m.default,{iconOnly:!0,type:"text",icon:(0,t.jsx)(d.Copy,{}),className:"px-1",text:e?.id??""})]})]}):(0,t.jsxs)(t.Fragment,{children:[a&&(0,t.jsx)("p",{children:s}),(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("p",{className:(0,h.cn)(a?"text-foreground-light text-sm":"text-foreground"),children:e.email}),(0,t.jsx)(m.default,{iconOnly:!0,type:"text",icon:(0,t.jsx)(d.Copy,{}),className:"px-1",text:e?.email??""})]})]})})}],795238)},691200,547268,521933,492375,810584,102541,e=>{"use strict";var t=e.i(38429),s=e.i(355901),a=e.i(234745);async function i({projectRef:e,userId:t}){let{data:s,error:i}=await (0,a.del)("/platform/auth/{ref}/users/{id}/factors",{params:{path:{ref:e,id:t}}});return i&&(0,a.handleError)(i),s}async function r({projectRef:e,user:t}){let{data:s,error:i}=await (0,a.post)("/platform/auth/{ref}/recover",{params:{path:{ref:e}},body:{email:t.email}});return i&&(0,a.handleError)(i),s}async function n({projectRef:e,user:t}){let{data:s,error:i}=await (0,a.post)("/platform/auth/{ref}/magiclink",{params:{path:{ref:e}},body:{email:t.email}});return i&&(0,a.handleError)(i),s}async function o({projectRef:e,user:t}){let{data:s,error:i}=await (0,a.post)("/platform/auth/{ref}/otp",{params:{path:{ref:e}},body:{phone:t.phone}});return i&&(0,a.handleError)(i),s}e.s(["useUserDeleteMFAFactorsMutation",0,({onSuccess:e,onError:a,...r}={})=>(0,t.useMutation)({mutationFn:e=>i(e),async onSuccess(t,s,a){await e?.(t,s,a)},async onError(e,t,i){void 0===a?s.toast.error(`Failed to delete the user's MFA factors: ${e.message}`):a(e,t,i)},...r})],691200),e.s(["useUserResetPasswordMutation",0,({onSuccess:e,onError:a,...i}={})=>(0,t.useMutation)({mutationFn:e=>r(e),async onSuccess(t,s,a){await e?.(t,s,a)},async onError(e,t,i){void 0===a?s.toast.error(`Failed to reset user password: ${e.message}`):a(e,t,i)},...i})],547268),e.s(["useUserSendMagicLinkMutation",0,({onSuccess:e,onError:a,...i}={})=>(0,t.useMutation)({mutationFn:e=>n(e),async onSuccess(t,s,a){await e?.(t,s,a)},async onError(e,t,i){void 0===a?s.toast.error(`Failed to send magic link: ${e.message}`):a(e,t,i)},...i})],521933),e.s(["useUserSendOTPMutation",0,({onSuccess:e,onError:a,...i}={})=>(0,t.useMutation)({mutationFn:e=>o(e),async onSuccess(t,s,a){await e?.(t,s,a)},async onError(e,t,i){void 0===a?s.toast.error(`Failed to send magic link: ${e.message}`):a(e,t,i)},...i})],492375);var l=e.i(356003),c=e.i(294285);async function u({projectRef:e,userId:t,banDuration:s}){let{data:i,error:r}=await (0,a.patch)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:e,id:t}},body:{ban_duration:"number"==typeof s?`${s}h`:s}});return r&&(0,a.handleError)(r),i}let d=({onSuccess:e,onError:a,...i}={})=>{let r=(0,l.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>u(e),async onSuccess(t,s,a){let{projectRef:i}=s;await r.invalidateQueries({queryKey:c.authKeys.usersInfinite(i)}),await e?.(t,s,a)},async onError(e,t,i){void 0===a?s.toast.error(`Failed to update user: ${e.message}`):a(e,t,i)},...i})};e.s(["useUserUpdateMutation",0,d],810584);var m=e.i(478902),h=e.i(532728),f=e.i(55956),p=e.i(389959),x=e.i(408891),g=e.i(531837);e.i(128328);var y=e.i(158639),v=e.i(837710),_=e.i(843778),j=e.i(428353),b=e.i(24315),w=e.i(61863),S=e.i(378277),k=e.i(40892),N=e.i(449123),E=e.i(451031),P=e.i(831927),C=e.i(156722),A=e.i(479095),M=e.i(538482);e.s(["BanUserModal",0,({visible:e,user:t,onClose:a})=>{let{ref:i}=(0,y.useParams)(),{mutate:r,isPending:n}=d({onSuccess:(e,t)=>{let i=(0,f.default)().add(Number(t.banDuration),"hours").format("DD MMM YYYY HH:mm (ZZ)");s.toast.success(`User banned successfully until ${i}`),a()}}),o=g.object({value:g.string().min(1,{message:"Please provide a duration"}),unit:g.enum(["hours","days"])}),l={value:"24",unit:"hours"},c=(0,x.useForm)({mode:"onBlur",reValidateMode:"onChange",resolver:(0,h.zodResolver)(o),defaultValues:l}),{value:u,unit:$}=c.watch(),T=(0,f.default)().add(Number(u),$).format("DD MMM YYYY HH:mm (ZZ)");return(0,p.useEffect)(()=>{e&&c.reset(l)},[e]),(0,m.jsx)(k.Modal,{hideFooter:!0,visible:e,size:"small",header:"Confirm to ban user",onCancel:()=>a(),children:(0,m.jsx)(j.Form_Shadcn_,{...c,children:(0,m.jsxs)("form",{onSubmit:c.handleSubmit(e=>{if(void 0===i)return console.error("Project ref is required");if(void 0===t.id)return s.toast.error("Failed to ban user: User ID not found");let a="hours"===e.unit?Number(e.value):24*Number(e.value);r({projectRef:i,userId:t.id,banDuration:a})}),children:[(0,m.jsxs)(k.Modal.Content,{className:"flex flex-col gap-y-3",children:[(0,m.jsx)("p",{className:"text-sm",children:"This will revoke the user's access to your project and prevent them from logging in for a specified duration."}),(0,m.jsxs)("div",{className:"flex items-start gap-x-2 [&>div:first-child]:flex-grow",children:[(0,m.jsx)(w.FormField_Shadcn_,{control:c.control,name:"value",render:({field:e})=>(0,m.jsx)(M.FormItemLayout,{className:"[&>div>div]:mt-0",label:"Set a ban duration",children:(0,m.jsx)(b.FormControl_Shadcn_,{children:(0,m.jsx)(S.Input_Shadcn_,{...e})})})}),(0,m.jsx)(w.FormField_Shadcn_,{control:c.control,name:"unit",render:({field:e})=>(0,m.jsx)(M.FormItemLayout,{className:"[&>div>div]:mt-0 mt-[33px]",children:(0,m.jsx)(b.FormControl_Shadcn_,{children:(0,m.jsxs)(N.Select_Shadcn_,{...e,value:e.value,onValueChange:e=>c.setValue("unit",e),children:[(0,m.jsx)(C.SelectTrigger_Shadcn_,{className:"capitalize w-24",children:e.value}),(0,m.jsxs)(E.SelectContent_Shadcn_,{children:[(0,m.jsx)(P.SelectItem_Shadcn_,{value:"hours",children:"Hours"}),(0,m.jsx)(P.SelectItem_Shadcn_,{value:"days",children:"Days"})]})]})})})})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-foreground-lighter",children:"This user will not be able to log in until:"}),(0,m.jsx)("p",{className:(0,_.cn)("text-sm",!u&&"text-foreground-light"),children:u?T:"Invalid duration set"})]})]}),(0,m.jsx)(A.Separator,{}),(0,m.jsxs)(k.Modal.Content,{className:"flex justify-end gap-2",children:[(0,m.jsx)(v.Button,{type:"default",disabled:n,onClick:()=>a(),children:"Cancel"}),(0,m.jsx)(v.Button,{type:"warning",htmlType:"submit",loading:n,children:"Confirm ban"})]})]})})})}],102541)},101385,e=>{"use strict";var t=e.i(478902),s=e.i(902858),a=e.i(55956),i=e.i(108444),r=e.i(370410),n=e.i(816467),o=e.i(906346),l=e.i(999918),c=e.i(211570),u=e.i(975924),d=e.i(215261),m=e.i(389959),h=e.i(355901);e.i(128328);var f=e.i(158639),p=e.i(215312),x=e.i(223600),g=e.i(14703),y=e.i(691200),v=e.i(547268),_=e.i(521933),j=e.i(492375),b=e.i(810584),w=e.i(2579),S=e.i(912793),k=e.i(10429),N=e.i(48189),E=e.i(837710),P=e.i(843778),C=e.i(479095),A=e.i(710483),M=e.i(466472),$=e.i(441730),T=e.i(102541),D=e.i(875430),U=e.i(795238),L=e.i(54592),I=e.i(71011);let O="DD MMM, YYYY HH:mm",F=(0,P.cn)("bg-surface-100 border-default text-foreground flex items-center justify-between","gap-x-4 border px-5 py-4 text-sm first:rounded-tr first:rounded-tl last:rounded-br last:rounded-bl"),R=({property:e,value:s})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2 group justify-between",children:[(0,t.jsx)("p",{className:" text-foreground-lighter text-xs",children:e}),"boolean"==typeof s?(0,t.jsx)("div",{className:"h-[26px] flex items-center justify-center min-w-[70px]",children:s?(0,t.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,t.jsx)(r.Check,{size:10,className:"text-contrast",strokeWidth:4})}):(0,t.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,t.jsx)(u.X,{size:10,className:"text-contrast",strokeWidth:4})})}):(0,t.jsxs)("div",{className:"flex items-center gap-x-2 h-[26px] font-mono min-w-[40px]",children:[(0,t.jsx)("p",{className:"text-xs",children:s||"-"}),!!s&&(0,t.jsx)(x.default,{iconOnly:!0,type:"text",icon:(0,t.jsx)(n.Copy,{}),className:"transition opacity-0 group-hover:opacity-100 px-1",text:s})]})]}),(0,t.jsx)(C.Separator,{})]}),B=({title:e,description:s,button:a,success:i,className:n})=>{let o=a?.disabled??!1;return(0,t.jsxs)("div",{className:(0,P.cn)(F,n),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:i?i.title:e}),(0,t.jsx)("p",{className:"text-xs text-foreground-light",children:i?i.description:s})]}),(0,t.jsx)(p.ButtonTooltip,{type:a?.type??"default",icon:i?(0,t.jsx)(r.Check,{className:"text-brand"}):a.icon,loading:a.isLoading??!1,onClick:a.onClick,disabled:o,tooltip:{content:{side:"bottom",text:o?`You need additional permissions to ${a.text.toLowerCase()}`:void 0}},children:a.text})]})};e.s(["RowAction",0,B,"RowData",0,R,"UserOverview",0,({user:e,onDeleteSuccess:n})=>{let{ref:u}=(0,f.useParams)(),p=null!==e.email,x=null!==e.phone,q=null!==e.banned_until,H=null!=e.confirmed_at,{authenticationSignInProviders:Q}=(0,S.useIsFeatureEnabled)(["authentication:sign_in_providers"]),z=(e.raw_app_meta_data?.providers??[]).map(e=>({name:e.startsWith("sso")?"SAML":e,icon:"email"===e?`${k.BASE_PATH}/img/icons/email-icon2.svg`:I.providerIconMap[e]?`${k.BASE_PATH}/img/icons/${I.providerIconMap[e]}.svg`:void 0})),{can:K}=(0,w.useAsyncCheckPermissions)(s.PermissionAction.AUTH_EXECUTE,"*"),{can:W}=(0,w.useAsyncCheckPermissions)(s.PermissionAction.AUTH_EXECUTE,"send_magic_link"),{can:G}=(0,w.useAsyncCheckPermissions)(s.PermissionAction.AUTH_EXECUTE,"send_recovery"),{can:Y}=(0,w.useAsyncCheckPermissions)(s.PermissionAction.AUTH_EXECUTE,"send_otp"),{can:V}=(0,w.useAsyncCheckPermissions)(s.PermissionAction.TENANT_SQL_DELETE,"auth.users"),{can:X}=(0,w.useAsyncCheckPermissions)(s.PermissionAction.TENANT_SQL_DELETE,"auth.mfa_factors"),[Z,J]=(0,m.useState)(),[ee,et]=(0,m.useState)(!1),[es,ea]=(0,m.useState)(!1),[ei,er]=(0,m.useState)(!1),[en,eo]=(0,m.useState)(!1),{data:el}=(0,g.useAuthConfigQuery)({projectRef:u}),ec=el?.MAILER_OTP_EXP??0,eu=Math.floor(ec/60),ed=Math.floor(ec%60),em=`${ec>60?`${eu} minute${eu>1?"s":""} ${ed>0?"and":""} `:""}${ed>0?`${ed} second${ed>1?"s":""}`:""}`,{mutate:eh,isPending:ef}=(0,v.useUserResetPasswordMutation)({onSuccess:(e,t)=>{J("send_recovery"),h.toast.success(`Sent password recovery to ${t.user.email}`)},onError:e=>{h.toast.error(`Failed to send password recovery: ${e.message}`)}}),{mutate:ep,isPending:ex}=(0,_.useUserSendMagicLinkMutation)({onSuccess:(e,t)=>{J("send_magic_link"),h.toast.success(H?`Sent magic link to ${t.user.email}`:`Sent confirmation email to ${t.user.email}`)},onError:e=>{h.toast.error(H?`Failed to send magic link: ${e.message}`:`Failed to send confirmation email: ${e.message}`)}}),{mutate:eg,isPending:ey}=(0,j.useUserSendOTPMutation)({onSuccess:(e,t)=>{J("send_otp"),h.toast.success(`Sent OTP to ${t.user.phone}`)},onError:e=>{h.toast.error(`Failed to send OTP: ${e.message}`)}}),{mutate:ev}=(0,y.useUserDeleteMFAFactorsMutation)({onSuccess:()=>{h.toast.success("Successfully deleted the user's factors"),eo(!1)}}),{mutate:e_,isPending:ej}=(0,b.useUserUpdateMutation)({onSuccess:()=>{h.toast.success("Successfully unbanned user"),ea(!1)}}),eb=async()=>{if(await (0,N.timeout)(200),!u)return console.error("Project ref is required");ev({projectRef:u,userId:e.id})};return(0,m.useEffect)(()=>{if(void 0!==Z){let e=setTimeout(()=>J(void 0),5e3);return()=>clearTimeout(e)}},[Z]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(U.UserHeader,{user:e}),q?(0,t.jsx)(A.Admonition,{type:"warning",label:`User banned until ${(0,a.default)(e.banned_until).format(O)}`,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5"}):(0,t.jsx)(C.Separator,{}),(0,t.jsxs)("div",{className:(0,P.cn)("flex flex-col gap-y-1",L.PANEL_PADDING),children:[(0,t.jsx)(R,{property:"User UID",value:e.id}),(0,t.jsx)(R,{property:"Created at",value:e.created_at?(0,a.default)(e.created_at).format(O):void 0}),(0,t.jsx)(R,{property:"Updated at",value:e.updated_at?(0,a.default)(e.updated_at).format(O):void 0}),(0,t.jsx)(R,{property:"Invited at",value:e.invited_at}),(0,t.jsx)(R,{property:"Confirmation sent at",value:e.confirmation_sent_at}),(0,t.jsx)(R,{property:"Confirmed at",value:e.confirmed_at?(0,a.default)(e.confirmed_at).format(O):void 0}),(0,t.jsx)(R,{property:"Last signed in",value:e.last_sign_in_at?(0,a.default)(e.last_sign_in_at).format(O):void 0}),(0,t.jsx)(R,{property:"SSO",value:e.is_sso_user})]}),(0,t.jsxs)("div",{className:(0,P.cn)("flex flex-col !pt-0",L.PANEL_PADDING),children:[(0,t.jsx)("p",{children:"Provider Information"}),(0,t.jsx)("p",{className:"text-sm text-foreground-light",children:"The user has the following providers"})]}),(0,t.jsx)("div",{className:(0,P.cn)("flex flex-col -space-y-1 !pt-0",L.PANEL_PADDING),children:z.map(e=>{let s=$.PROVIDERS_SCHEMAS.find(t=>"key"in t&&t.key===e.name||t.title.toLowerCase()===e.name),a=Object.keys(s?.properties??{}).find(e=>e.toLowerCase().endsWith("_enabled")),i="email"===e.name?e.name.toLowerCase():s?.title??e.name,n=el?.[a]??!1;return(0,t.jsxs)("div",{className:(0,P.cn)(F,"items-start justify-start"),children:[e.icon&&(0,t.jsx)("img",{width:16,src:e.icon,alt:`${e.name} auth icon`,className:(0,P.cn)("mt-1.5","github"===e.name?"dark:invert":"")}),(0,t.jsxs)("div",{className:"flex-grow mt-0.5",children:[(0,t.jsx)("p",{className:"capitalize",children:i}),(0,t.jsxs)("p",{className:"text-xs text-foreground-light",children:["Signed in with a ",i," account via"," ","SAML"===i?"SSO":"OAuth"]}),Q&&(0,t.jsx)(E.Button,{asChild:!0,type:"default",className:"mt-2",children:(0,t.jsxs)(d.default,{href:`/project/${u}/auth/providers?provider=${"SAML"===e.name?"SAML 2.0":e.name}`,children:["Configure ",i," provider"]})})]}),n?(0,t.jsxs)("div",{className:"flex items-center gap-1 rounded-full border border-brand-400 bg-brand-200 py-1 px-1 text-xs text-brand",children:[(0,t.jsx)("span",{className:"rounded-full bg-brand p-0.5 text-xs text-brand-200",children:(0,t.jsx)(r.Check,{strokeWidth:2,size:12})}),(0,t.jsx)("span",{className:"px-1",children:"Enabled"})]}):(0,t.jsx)("div",{className:"rounded-md border border-strong bg-surface-100 py-1 px-3 text-xs text-foreground-lighter",children:"Disabled"})]},e.name)})}),(0,t.jsx)(C.Separator,{}),(0,t.jsxs)("div",{className:(0,P.cn)("flex flex-col -space-y-1",L.PANEL_PADDING),children:[p&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B,{title:"Reset password",description:"Send a password recovery email to the user",button:{icon:(0,t.jsx)(o.Mail,{}),text:"Send password recovery",isLoading:ef,disabled:!G,onClick:()=>{u&&eh({projectRef:u,user:e})}},success:"send_recovery"===Z?{title:"Password recovery sent",description:`The link in the email is valid for ${em}`}:void 0}),(0,t.jsx)(B,{title:H?"Send Magic Link":"Send confirmation email",description:H?"Passwordless login via email for the user":"Send a confirmation email to the user",button:{icon:(0,t.jsx)(o.Mail,{}),text:H?"Send magic link":"Send confirmation email",isLoading:ex,disabled:!W,onClick:()=>{u&&ep({projectRef:u,user:e})}},success:"send_magic_link"===Z?{title:H?"Magic link sent":"Confirmation email sent",description:H?`The link in the email is valid for ${em}`:"The confirmation email has been sent to the user"}:void 0})]}),x&&(0,t.jsx)(B,{title:"Send OTP",description:"Passwordless login via phone for the user",button:{icon:(0,t.jsx)(o.Mail,{}),text:"Send OTP",isLoading:ey,disabled:!Y,onClick:()=>{u&&eg({projectRef:u,user:e})}},success:"send_otp"===Z?{title:"OTP sent",description:`The link in the OTP SMS is valid for ${em}`}:void 0})]}),(0,t.jsx)(C.Separator,{}),(0,t.jsxs)("div",{className:(0,P.cn)("flex flex-col",L.PANEL_PADDING),children:[(0,t.jsx)("p",{children:"Danger zone"}),(0,t.jsx)("p",{className:"text-sm text-foreground-light",children:"Be wary of the following features as they cannot be undone."})]}),(0,t.jsxs)("div",{className:(0,P.cn)("flex flex-col -space-y-1 !pt-0",L.PANEL_PADDING),children:[(0,t.jsx)(B,{title:"Remove MFA factors",description:"Removes all MFA factors associated with the user",button:{icon:(0,t.jsx)(l.ShieldOff,{}),text:"Remove MFA factors",disabled:!X,onClick:()=>eo(!0)},className:"!bg border-destructive-400"}),(0,t.jsx)(B,{title:q?`User is banned until ${(0,a.default)(e.banned_until).format(O)}`:"Ban user",description:q?"User has no access to the project until after this date":"Revoke access to the project for a set duration",button:{icon:(0,t.jsx)(i.Ban,{}),text:q?"Unban user":"Ban user",disabled:!K,onClick:()=>{q?ea(!0):et(!0)}},className:"!bg border-destructive-400"}),(0,t.jsx)(B,{title:"Delete user",description:"User will no longer have access to the project",button:{icon:(0,t.jsx)(c.Trash,{}),type:"danger",text:"Delete user",disabled:!V,onClick:()=>er(!0)},className:"!bg border-destructive-400"})]})]}),(0,t.jsx)(D.DeleteUserModal,{visible:ei,selectedUser:e,onClose:()=>er(!1),onDeleteSuccess:()=>{er(!1),n()}}),(0,t.jsx)(M.default,{visible:en,variant:"warning",title:"Confirm to remove MFA factors",confirmLabel:"Remove factors",confirmLabelLoading:"Removing",onCancel:()=>eo(!1),onConfirm:()=>eb(),alert:{base:{variant:"warning"},title:"Removing MFA factors will drop the user's authentication assurance level (AAL) to AAL1",description:"Note that this does not sign the user out"},children:(0,t.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove the MFA factors for the user"," ",(0,t.jsx)("span",{className:"text-foreground",children:e.email??e.phone??"this user"}),"?"]})}),(0,t.jsx)(T.BanUserModal,{visible:ee,user:e,onClose:()=>et(!1)}),(0,t.jsx)(M.default,{variant:"warning",visible:es,title:"Confirm to unban user",loading:ej,confirmLabel:"Unban user",confirmLabelLoading:"Unbanning",onCancel:()=>ea(!1),onConfirm:()=>void 0===u?console.error("Project ref is required"):void 0===e.id?h.toast.error("Failed to ban user: User ID not found"):void e_({projectRef:u,userId:e.id,banDuration:"none"}),children:(0,t.jsx)("p",{className:"text-sm text-foreground-light",children:"The user will have access to your project again once unbanned. Are you sure you want to unban this user?"})})]})}])},111410,e=>{e.v(t=>Promise.all(["static/chunks/a428d2b7e6671266.js","static/chunks/92a7c4be60dd12e3.js"].map(t=>e.l(t))).then(()=>t(677146)))},883471,e=>{e.v(t=>Promise.all(["static/chunks/69b2faaedd35af23.js"].map(t=>e.l(t))).then(()=>t(518769)))},587525,e=>{e.v(t=>Promise.all(["static/chunks/da2f61ca91d09b7f.js"].map(t=>e.l(t))).then(()=>t(127351)))},168845,e=>{e.v(t=>Promise.all(["static/chunks/99714db866f77205.js"].map(t=>e.l(t))).then(()=>t(238625)))},591393,e=>{e.v(t=>Promise.all(["static/chunks/e9ad074e72197584.js"].map(t=>e.l(t))).then(()=>t(217383)))},379416,e=>{e.v(t=>Promise.all(["static/chunks/d690909a90d04a2e.js"].map(t=>e.l(t))).then(()=>t(931066)))},15732,e=>{e.v(t=>Promise.all(["static/chunks/0d5256e667945be4.js"].map(t=>e.l(t))).then(()=>t(760545)))},957083,e=>{e.v(t=>Promise.all(["static/chunks/e7d07ff1ae210964.js"].map(t=>e.l(t))).then(()=>t(667558)))},207969,e=>{e.v(t=>Promise.all(["static/chunks/8dd7282c22f923f6.js"].map(t=>e.l(t))).then(()=>t(427328)))},992842,e=>{e.v(t=>Promise.all(["static/chunks/d064a48a1c7cf778.js"].map(t=>e.l(t))).then(()=>t(793794)))},239573,e=>{e.v(t=>Promise.all(["static/chunks/edc5d84148401903.js"].map(t=>e.l(t))).then(()=>t(210246)))},963685,e=>{e.v(t=>Promise.all(["static/chunks/92b20126e5ca0919.js"].map(t=>e.l(t))).then(()=>t(983756)))},665811,e=>{e.v(t=>Promise.all(["static/chunks/e37e25f8b82619ef.js"].map(t=>e.l(t))).then(()=>t(544836)))},369256,e=>{e.v(t=>Promise.all(["static/chunks/8296dc618dae72f0.js"].map(t=>e.l(t))).then(()=>t(930239)))},16037,e=>{e.v(t=>Promise.all(["static/chunks/3251b4bc539a554b.js"].map(t=>e.l(t))).then(()=>t(397698)))},616788,e=>{e.v(t=>Promise.all(["static/chunks/c6b81ab43a1d5d23.js"].map(t=>e.l(t))).then(()=>t(7346)))},315750,e=>{e.v(t=>Promise.all(["static/chunks/32c236321136eb7c.js"].map(t=>e.l(t))).then(()=>t(531289)))},460510,e=>{e.v(t=>Promise.all(["static/chunks/d91062943e6a7c30.js"].map(t=>e.l(t))).then(()=>t(276898)))},550265,e=>{e.v(t=>Promise.all(["static/chunks/75ff0e62b8a31d26.js"].map(t=>e.l(t))).then(()=>t(259714)))},830960,e=>{e.v(t=>Promise.all(["static/chunks/b44aa26556fee7df.js"].map(t=>e.l(t))).then(()=>t(882885)))},336744,e=>{e.v(t=>Promise.all(["static/chunks/2b0767b5c008139a.js"].map(t=>e.l(t))).then(()=>t(955268)))},63631,e=>{e.v(t=>Promise.all(["static/chunks/21a4706e1f02d90b.js"].map(t=>e.l(t))).then(()=>t(853630)))},912072,e=>{e.v(t=>Promise.all(["static/chunks/c17c80e5efc43419.js"].map(t=>e.l(t))).then(()=>t(311301)))},730314,e=>{e.v(t=>Promise.all(["static/chunks/dcadd9d46d72282e.js","static/chunks/810617c09317cd83.js","static/chunks/82dddbda1a808189.js","static/chunks/d3a06a9a43f3833e.js","static/chunks/87b9766a4d16d1da.js","static/chunks/cc8130a84ee9bc2c.css"].map(t=>e.l(t))).then(()=>t(686651)))}]);

//# debugId=cf96cd9a-1366-4a35-535f-8a990ae7a170
//# sourceMappingURL=44635ac87a95d1a2.js.map